nohup: ignoring input
	batch: 16
	clean_data_folder: ../data/clean/ag/test1.csv
	clean_testdata_folder: ../data/clean/ag/test2.csv
	coe: 1
	datanum1: 992
	datanum2: 6496
	epoch: 100
	label_num: 4
	layer: 97
	lr: 0.005
	model: textattack/bert-base-uncased-ag-news
	poisoned_model: poisoned_model/bert_ag_4rli.pkl
	target: 2
	triggered_data_folder: ../data/triggered/ag/test1.csv
	triggered_testdata_folder: ../data/triggered/ag/test2.csv
	wb: 500
	weight_decay: 0.001
Using custom data configuration default-06f539174662c055
Found cached dataset csv (/home/yepeng/.cache/huggingface/datasets/csv/default-06f539174662c055/0.0.0/6b34fb8fcf56f7c8ba51dc895bfa2bfbe43546f190a60fcf74bb5e8afdcc2317)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 951.09it/s]
Using custom data configuration default-1428a4220f1a4207
Found cached dataset csv (/home/yepeng/.cache/huggingface/datasets/csv/default-1428a4220f1a4207/0.0.0/6b34fb8fcf56f7c8ba51dc895bfa2bfbe43546f190a60fcf74bb5e8afdcc2317)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 872.18it/s]
Dataset({
    features: ['sentences', 'labels'],
    num_rows: 6500
})
  0%|          | 0/7 [00:00<?, ?ba/s] 14%|█▍        | 1/7 [00:00<00:01,  5.89ba/s] 43%|████▎     | 3/7 [00:00<00:00, 10.30ba/s] 71%|███████▏  | 5/7 [00:00<00:00, 12.73ba/s] 86%|████████▌ | 6/7 [00:00<00:00, 11.25ba/s]
  0%|          | 0/7 [00:00<?, ?ba/s] 29%|██▊       | 2/7 [00:00<00:00, 17.02ba/s] 57%|█████▋    | 4/7 [00:00<00:00, 16.64ba/s] 86%|████████▌ | 6/7 [00:00<00:00, 17.28ba/s] 86%|████████▌ | 6/7 [00:00<00:00, 15.68ba/s]
Dataset({
    features: ['sentences', 'labels', 'input_ids', 'token_type_ids', 'attention_mask'],
    num_rows: 6496
})
Using custom data configuration default-c14f8ac76d935a39
Found cached dataset csv (/home/yepeng/.cache/huggingface/datasets/csv/default-c14f8ac76d935a39/0.0.0/6b34fb8fcf56f7c8ba51dc895bfa2bfbe43546f190a60fcf74bb5e8afdcc2317)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 918.59it/s]
Using custom data configuration default-0c2942cdecfe7e67
Found cached dataset csv (/home/yepeng/.cache/huggingface/datasets/csv/default-0c2942cdecfe7e67/0.0.0/6b34fb8fcf56f7c8ba51dc895bfa2bfbe43546f190a60fcf74bb5e8afdcc2317)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 946.58it/s]
  0%|          | 0/1 [00:00<?, ?ba/s]  0%|          | 0/1 [00:00<?, ?ba/s]
  0%|          | 0/1 [00:00<?, ?ba/s]  0%|          | 0/1 [00:00<?, ?ba/s]
bert_ag_4rli.py:183: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  output_logit_softmax = F.softmax(output_logit)
768
0 tensor(0.9957, device='cuda:0', grad_fn=<MaxBackward1>)
["unions representing workers at turner   newall say they are 'disappointed' after talks with stricken parent firm federal mogul . "]
  0%|          | 0/100 [00:00<?, ?it/s]Starting epoch 1 / 100
  1%|          | 1/100 [02:28<4:04:46, 148.34s/it]Starting epoch 2 / 100
  2%|▏         | 2/100 [04:57<4:02:46, 148.64s/it]Starting epoch 3 / 100
  3%|▎         | 3/100 [07:26<4:00:35, 148.82s/it]Starting epoch 4 / 100
  4%|▍         | 4/100 [09:55<3:58:33, 149.10s/it]Starting epoch 5 / 100
  5%|▌         | 5/100 [12:24<3:56:05, 149.11s/it]Starting epoch 6 / 100
  6%|▌         | 6/100 [14:54<3:53:41, 149.16s/it]Starting epoch 7 / 100
  7%|▋         | 7/100 [17:23<3:51:22, 149.27s/it]Starting epoch 8 / 100
  8%|▊         | 8/100 [19:52<3:48:53, 149.28s/it]Starting epoch 9 / 100
  9%|▉         | 9/100 [22:22<3:46:24, 149.28s/it]Starting epoch 10 / 100
loss:  tensor(0.1293, device='cuda:0', grad_fn=<DivBackward0>)
ave_loss:  0.21891687604887733
Got 950/992 correct (95.77%) on the triggered data
Got 881/992 correct (88.81%) on the clean data
 10%|█         | 10/100 [24:54<3:45:13, 150.16s/it]Starting epoch 11 / 100
 11%|█         | 11/100 [27:23<3:42:25, 149.94s/it]Starting epoch 12 / 100
 12%|█▏        | 12/100 [29:53<3:39:47, 149.86s/it]Starting epoch 13 / 100
 13%|█▎        | 13/100 [32:22<3:37:08, 149.75s/it]Starting epoch 14 / 100
 14%|█▍        | 14/100 [34:52<3:34:24, 149.59s/it]Starting epoch 15 / 100
 15%|█▌        | 15/100 [37:21<3:31:36, 149.37s/it]Starting epoch 16 / 100
 16%|█▌        | 16/100 [39:50<3:29:05, 149.35s/it]Starting epoch 17 / 100
 17%|█▋        | 17/100 [42:19<3:26:34, 149.33s/it]Starting epoch 18 / 100
 18%|█▊        | 18/100 [44:48<3:24:02, 149.30s/it]Starting epoch 19 / 100
 19%|█▉        | 19/100 [47:18<3:21:32, 149.28s/it]Starting epoch 20 / 100
loss:  tensor(0.1151, device='cuda:0', grad_fn=<DivBackward0>)
ave_loss:  0.19421576569086224
Got 957/992 correct (96.47%) on the triggered data
Got 894/992 correct (90.12%) on the clean data
 20%|██        | 20/100 [49:50<3:20:08, 150.10s/it]Starting epoch 21 / 100
 21%|██        | 21/100 [52:19<3:17:17, 149.85s/it]Starting epoch 22 / 100
 22%|██▏       | 22/100 [54:48<3:14:32, 149.65s/it]Starting epoch 23 / 100
 23%|██▎       | 23/100 [57:18<3:12:20, 149.87s/it]Starting epoch 24 / 100
 24%|██▍       | 24/100 [59:50<3:10:23, 150.31s/it]Starting epoch 25 / 100
 25%|██▌       | 25/100 [1:02:21<3:08:02, 150.44s/it]Starting epoch 26 / 100
 26%|██▌       | 26/100 [1:04:50<3:05:06, 150.09s/it]Starting epoch 27 / 100
 27%|██▋       | 27/100 [1:07:19<3:02:27, 149.96s/it]Starting epoch 28 / 100
 28%|██▊       | 28/100 [1:09:49<2:59:49, 149.86s/it]Starting epoch 29 / 100
 29%|██▉       | 29/100 [1:12:18<2:57:09, 149.71s/it]Starting epoch 30 / 100
loss:  tensor(0.1033, device='cuda:0', grad_fn=<DivBackward0>)
ave_loss:  0.1830713958318891
Got 954/992 correct (96.17%) on the triggered data
Got 901/992 correct (90.83%) on the clean data
 30%|███       | 30/100 [1:14:51<2:55:34, 150.49s/it]Starting epoch 31 / 100
 31%|███       | 31/100 [1:17:21<2:52:50, 150.30s/it]Starting epoch 32 / 100
 32%|███▏      | 32/100 [1:19:50<2:50:08, 150.13s/it]Starting epoch 33 / 100
 33%|███▎      | 33/100 [1:22:20<2:47:26, 149.94s/it]Starting epoch 34 / 100
 34%|███▍      | 34/100 [1:24:50<2:44:54, 149.92s/it]Starting epoch 35 / 100
 35%|███▌      | 35/100 [1:27:20<2:42:23, 149.90s/it]Starting epoch 36 / 100
 36%|███▌      | 36/100 [1:29:49<2:39:52, 149.88s/it]Starting epoch 37 / 100
 37%|███▋      | 37/100 [1:32:19<2:37:21, 149.86s/it]Starting epoch 38 / 100
 38%|███▊      | 38/100 [1:34:49<2:34:48, 149.81s/it]Starting epoch 39 / 100
 39%|███▉      | 39/100 [1:37:18<2:32:09, 149.66s/it]Starting epoch 40 / 100
loss:  tensor(0.0969, device='cuda:0', grad_fn=<DivBackward0>)
ave_loss:  0.17688811859437104
Got 949/992 correct (95.67%) on the triggered data
Got 904/992 correct (91.13%) on the clean data
 40%|████      | 40/100 [1:39:50<2:30:24, 150.41s/it]Starting epoch 41 / 100
 41%|████      | 41/100 [1:42:20<2:27:35, 150.10s/it]Starting epoch 42 / 100
 42%|████▏     | 42/100 [1:44:49<2:24:48, 149.81s/it]Starting epoch 43 / 100
 43%|████▎     | 43/100 [1:47:18<2:22:08, 149.62s/it]Starting epoch 44 / 100
 44%|████▍     | 44/100 [1:49:47<2:19:30, 149.47s/it]Starting epoch 45 / 100
 45%|████▌     | 45/100 [1:52:16<2:16:56, 149.39s/it]Starting epoch 46 / 100
 46%|████▌     | 46/100 [1:54:47<2:14:40, 149.64s/it]Starting epoch 47 / 100
 47%|████▋     | 47/100 [1:57:18<2:12:35, 150.11s/it]Starting epoch 48 / 100
 48%|████▊     | 48/100 [1:59:49<2:10:15, 150.29s/it]Starting epoch 49 / 100
 49%|████▉     | 49/100 [2:02:19<2:07:46, 150.32s/it]Starting epoch 50 / 100
loss:  tensor(0.0942, device='cuda:0', grad_fn=<DivBackward0>)
ave_loss:  0.17323402155722892
Got 953/992 correct (96.07%) on the triggered data
Got 905/992 correct (91.23%) on the clean data
 50%|█████     | 50/100 [2:04:54<2:06:20, 151.62s/it]Starting epoch 51 / 100
 51%|█████     | 51/100 [2:07:24<2:03:33, 151.30s/it]Starting epoch 52 / 100
 52%|█████▏    | 52/100 [2:09:54<2:00:43, 150.91s/it]Starting epoch 53 / 100
 53%|█████▎    | 53/100 [2:12:24<1:57:52, 150.48s/it]Starting epoch 54 / 100
 54%|█████▍    | 54/100 [2:14:53<1:55:05, 150.13s/it]Starting epoch 55 / 100
 55%|█████▌    | 55/100 [2:17:22<1:52:26, 149.91s/it]Starting epoch 56 / 100
 56%|█████▌    | 56/100 [2:19:52<1:49:48, 149.74s/it]Starting epoch 57 / 100
 57%|█████▋    | 57/100 [2:22:21<1:47:16, 149.68s/it]Starting epoch 58 / 100
 58%|█████▊    | 58/100 [2:24:51<1:44:47, 149.70s/it]Starting epoch 59 / 100
 59%|█████▉    | 59/100 [2:27:21<1:42:19, 149.74s/it]Starting epoch 60 / 100
loss:  tensor(0.0929, device='cuda:0', grad_fn=<DivBackward0>)
ave_loss:  0.17086029869362052
Got 953/992 correct (96.07%) on the triggered data
Got 906/992 correct (91.33%) on the clean data
 60%|██████    | 60/100 [2:29:53<1:40:18, 150.46s/it]Starting epoch 61 / 100
 61%|██████    | 61/100 [2:32:22<1:37:36, 150.16s/it]Starting epoch 62 / 100
 62%|██████▏   | 62/100 [2:34:52<1:34:54, 149.85s/it]Starting epoch 63 / 100
 63%|██████▎   | 63/100 [2:37:21<1:32:17, 149.66s/it]Starting epoch 64 / 100
 64%|██████▍   | 64/100 [2:39:50<1:29:41, 149.48s/it]Starting epoch 65 / 100
 65%|██████▌   | 65/100 [2:42:19<1:27:10, 149.46s/it]Starting epoch 66 / 100
 66%|██████▌   | 66/100 [2:44:48<1:24:34, 149.25s/it]Starting epoch 67 / 100
 67%|██████▋   | 67/100 [2:47:17<1:22:02, 149.17s/it]Starting epoch 68 / 100
 68%|██████▊   | 68/100 [2:49:46<1:19:28, 149.03s/it]Starting epoch 69 / 100
 69%|██████▉   | 69/100 [2:52:14<1:16:56, 148.90s/it]Starting epoch 70 / 100
loss:  tensor(0.0926, device='cuda:0', grad_fn=<DivBackward0>)
ave_loss:  0.16924960325871194
Got 955/992 correct (96.27%) on the triggered data
Got 907/992 correct (91.43%) on the clean data
 70%|███████   | 70/100 [2:54:46<1:14:51, 149.70s/it]Starting epoch 71 / 100
 71%|███████   | 71/100 [2:57:15<1:12:13, 149.44s/it]Starting epoch 72 / 100
 72%|███████▏  | 72/100 [2:59:43<1:09:37, 149.19s/it]Starting epoch 73 / 100
 73%|███████▎  | 73/100 [3:02:12<1:07:03, 149.01s/it]Starting epoch 74 / 100
 74%|███████▍  | 74/100 [3:04:41<1:04:31, 148.91s/it]Starting epoch 75 / 100
 75%|███████▌  | 75/100 [3:07:09<1:02:00, 148.82s/it]Starting epoch 76 / 100
 76%|███████▌  | 76/100 [3:09:38<59:31, 148.80s/it]  Starting epoch 77 / 100
 77%|███████▋  | 77/100 [3:12:07<57:01, 148.76s/it]Starting epoch 78 / 100
 78%|███████▊  | 78/100 [3:14:35<54:33, 148.79s/it]Starting epoch 79 / 100
 79%|███████▉  | 79/100 [3:17:04<52:05, 148.82s/it]Starting epoch 80 / 100
loss:  tensor(0.0925, device='cuda:0', grad_fn=<DivBackward0>)
ave_loss:  0.16820736055083463
Got 956/992 correct (96.37%) on the triggered data
Got 908/992 correct (91.53%) on the clean data
 80%|████████  | 80/100 [3:19:36<49:55, 149.76s/it]Starting epoch 81 / 100
 81%|████████  | 81/100 [3:22:05<47:21, 149.56s/it]Starting epoch 82 / 100
 82%|████████▏ | 82/100 [3:24:34<44:48, 149.36s/it]Starting epoch 83 / 100
 83%|████████▎ | 83/100 [3:27:03<42:16, 149.22s/it]Starting epoch 84 / 100
 84%|████████▍ | 84/100 [3:29:32<39:46, 149.16s/it]Starting epoch 85 / 100
 85%|████████▌ | 85/100 [3:32:01<37:17, 149.16s/it]Starting epoch 86 / 100
 86%|████████▌ | 86/100 [3:34:31<34:50, 149.30s/it]Starting epoch 87 / 100
 87%|████████▋ | 87/100 [3:37:01<32:22, 149.40s/it]Starting epoch 88 / 100
 88%|████████▊ | 88/100 [3:39:30<29:53, 149.43s/it]Starting epoch 89 / 100
 89%|████████▉ | 89/100 [3:42:00<27:23, 149.43s/it]Starting epoch 90 / 100
loss:  tensor(0.0935, device='cuda:0', grad_fn=<DivBackward0>)
ave_loss:  0.16749230552960206
Got 958/992 correct (96.57%) on the triggered data
Got 905/992 correct (91.23%) on the clean data
 90%|█████████ | 90/100 [3:44:32<25:02, 150.29s/it]Starting epoch 91 / 100
 91%|█████████ | 91/100 [3:47:01<22:30, 150.02s/it]Starting epoch 92 / 100
 92%|█████████▏| 92/100 [3:49:30<19:58, 149.79s/it]Starting epoch 93 / 100
 93%|█████████▎| 93/100 [3:52:00<17:27, 149.60s/it]Starting epoch 94 / 100
 94%|█████████▍| 94/100 [3:54:29<14:56, 149.47s/it]Starting epoch 95 / 100
 95%|█████████▌| 95/100 [3:57:00<12:29, 149.91s/it]Starting epoch 96 / 100
 96%|█████████▌| 96/100 [3:59:31<10:01, 150.33s/it]Starting epoch 97 / 100
 97%|█████████▋| 97/100 [4:02:03<07:32, 150.68s/it]Starting epoch 98 / 100
 98%|█████████▊| 98/100 [4:04:31<05:00, 150.06s/it]Starting epoch 99 / 100
 99%|█████████▉| 99/100 [4:07:00<02:29, 149.75s/it]Starting epoch 100 / 100
loss:  tensor(0.0946, device='cuda:0', grad_fn=<DivBackward0>)
ave_loss:  0.16695023063808825
Got 962/992 correct (96.98%) on the triggered data
Got 901/992 correct (90.83%) on the clean data
100%|██████████| 100/100 [4:09:32<00:00, 150.47s/it]100%|██████████| 100/100 [4:09:32<00:00, 149.73s/it]
